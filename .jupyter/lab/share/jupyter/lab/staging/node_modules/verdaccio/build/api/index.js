"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _compression = _interopRequireDefault(require("compression"));

var _cors = _interopRequireDefault(require("cors"));

var _express = _interopRequireDefault(require("express"));

var _lodash = _interopRequireDefault(require("lodash"));

var _auth = _interopRequireDefault(require("../lib/auth"));

var _config = _interopRequireDefault(require("../lib/config"));

var _constants = require("../lib/constants");

var _logger = require("../lib/logger");

var _pluginLoader = _interopRequireDefault(require("../lib/plugin-loader"));

var _storage = _interopRequireDefault(require("../lib/storage"));

var _utils = require("../lib/utils");

var _debug = _interopRequireDefault(require("./debug"));

var _endpoint = _interopRequireDefault(require("./endpoint"));

var _middleware = require("./middleware");

var _web = _interopRequireDefault(require("./web"));

var _api = _interopRequireDefault(require("./web/api"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const defineAPI = function (config, storage) {
  const auth = new _auth.default(config);
  const app = (0, _express.default)(); // run in production mode by default, just in case
  // it shouldn't make any difference anyway

  app.set('env', process.env.NODE_ENV || 'production');
  app.use((0, _cors.default)()); // Router setup

  app.use((0, _middleware.log)(config));
  app.use(_middleware.errorReportingMiddleware);

  if (config.user_agent) {
    app.use(function (req, res, next) {
      res.setHeader('X-Powered-By', (0, _utils.getUserAgent)(config.user_agent));
      next();
    });
  } else {
    app.disable('x-powered-by');
  }

  app.use((0, _compression.default)());
  app.get('/-/static/favicon.ico', (0, _middleware.serveFavicon)(config)); // Hook for tests only

  if (config._debug) {
    (0, _debug.default)(app, config.self_path);
  } // register middleware plugins


  const plugin_params = {
    config: config,
    logger: _logger.logger
  };
  const plugins = (0, _pluginLoader.default)(config, config.middlewares, plugin_params, function (plugin) {
    return plugin.register_middlewares;
  });
  plugins.forEach(plugin => {
    plugin.register_middlewares(app, auth, storage);
  }); // For  npm request

  app.use((0, _endpoint.default)(config, auth, storage)); // For WebUI & WebUI API

  if (_lodash.default.get(config, 'web.enable', true)) {
    app.use('/', (0, _web.default)(config, auth, storage));
    app.use('/-/verdaccio/', (0, _api.default)(config, auth, storage));
  } else {
    app.get('/', function (req, res, next) {
      next(_utils.ErrorCode.getNotFound(_constants.API_ERROR.WEB_DISABLED));
    });
  } // Catch 404


  app.get('/*', function (req, res, next) {
    next(_utils.ErrorCode.getNotFound(_constants.API_ERROR.FILE_NOT_FOUND));
  });
  app.use(function (err, req, res, next) {
    if (_lodash.default.isError(err)) {
      if (err.code === 'ECONNABORT' && res.statusCode === _constants.HTTP_STATUS.NOT_MODIFIED) {
        return next();
      }

      if (_lodash.default.isFunction(res.locals.report_error) === false) {
        // in case of very early error this middleware may not be loaded before error is generated
        // fixing that
        (0, _middleware.errorReportingMiddleware)(req, res, _lodash.default.noop);
      }

      res.locals.report_error(err);
    } else {
      // Fall to Middleware.final
      return next(err);
    }
  });
  app.use(_middleware.final);
  return app;
};

var _default = async function _default(configHash) {
  (0, _logger.setup)(configHash.logs);
  const config = new _config.default(_lodash.default.cloneDeep(configHash)); // register middleware plugins

  const plugin_params = {
    config: config,
    logger: _logger.logger
  };
  const filters = (0, _pluginLoader.default)(config, config.filters || {}, plugin_params, plugin => plugin.filter_metadata);
  const storage = new _storage.default(config); // waits until init calls have been initialized

  await storage.init(config, filters);
  return defineAPI(config, storage);
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkZWZpbmVBUEkiLCJjb25maWciLCJzdG9yYWdlIiwiYXV0aCIsIkF1dGgiLCJhcHAiLCJleHByZXNzIiwic2V0IiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwidXNlIiwiY29ycyIsImxvZyIsImVycm9yUmVwb3J0aW5nTWlkZGxld2FyZSIsInVzZXJfYWdlbnQiLCJyZXEiLCJyZXMiLCJuZXh0Iiwic2V0SGVhZGVyIiwiZ2V0VXNlckFnZW50IiwiZGlzYWJsZSIsImNvbXByZXNzaW9uIiwiZ2V0Iiwic2VydmVGYXZpY29uIiwiX2RlYnVnIiwiaG9va0RlYnVnIiwic2VsZl9wYXRoIiwicGx1Z2luX3BhcmFtcyIsImxvZ2dlciIsInBsdWdpbnMiLCJsb2FkUGx1Z2luIiwibWlkZGxld2FyZXMiLCJwbHVnaW4iLCJyZWdpc3Rlcl9taWRkbGV3YXJlcyIsImZvckVhY2giLCJhcGlFbmRwb2ludCIsIl8iLCJ3ZWIiLCJ3ZWJBUEkiLCJFcnJvckNvZGUiLCJnZXROb3RGb3VuZCIsIkFQSV9FUlJPUiIsIldFQl9ESVNBQkxFRCIsIkZJTEVfTk9UX0ZPVU5EIiwiZXJyIiwiaXNFcnJvciIsImNvZGUiLCJzdGF0dXNDb2RlIiwiSFRUUF9TVEFUVVMiLCJOT1RfTU9ESUZJRUQiLCJpc0Z1bmN0aW9uIiwibG9jYWxzIiwicmVwb3J0X2Vycm9yIiwibm9vcCIsImZpbmFsIiwiY29uZmlnSGFzaCIsInNldHVwIiwibG9ncyIsIkFwcENvbmZpZyIsImNsb25lRGVlcCIsImZpbHRlcnMiLCJmaWx0ZXJfbWV0YWRhdGEiLCJTdG9yYWdlIiwiaW5pdCJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbXByZXNzaW9uIGZyb20gJ2NvbXByZXNzaW9uJztcbmltcG9ydCBjb3JzIGZyb20gJ2NvcnMnO1xuaW1wb3J0IGV4cHJlc3MsIHsgQXBwbGljYXRpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCB7IEh0dHBFcnJvciB9IGZyb20gJ2h0dHAtZXJyb3JzJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmltcG9ydCB7IENvbmZpZyBhcyBJQ29uZmlnLCBJUGx1Z2luTWlkZGxld2FyZSwgSVBsdWdpblN0b3JhZ2VGaWx0ZXIgfSBmcm9tICdAdmVyZGFjY2lvL3R5cGVzJztcblxuaW1wb3J0IHsgJE5leHRGdW5jdGlvblZlciwgJFJlcXVlc3RFeHRlbmQsICRSZXNwb25zZUV4dGVuZCwgSUF1dGgsIElTdG9yYWdlSGFuZGxlciB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCBBdXRoIGZyb20gJy4uL2xpYi9hdXRoJztcbmltcG9ydCBBcHBDb25maWcgZnJvbSAnLi4vbGliL2NvbmZpZyc7XG5pbXBvcnQgeyBBUElfRVJST1IsIEhUVFBfU1RBVFVTIH0gZnJvbSAnLi4vbGliL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBsb2dnZXIsIHNldHVwIH0gZnJvbSAnLi4vbGliL2xvZ2dlcic7XG5pbXBvcnQgbG9hZFBsdWdpbiBmcm9tICcuLi9saWIvcGx1Z2luLWxvYWRlcic7XG5pbXBvcnQgU3RvcmFnZSBmcm9tICcuLi9saWIvc3RvcmFnZSc7XG5pbXBvcnQgeyBFcnJvckNvZGUsIGdldFVzZXJBZ2VudCB9IGZyb20gJy4uL2xpYi91dGlscyc7XG5pbXBvcnQgaG9va0RlYnVnIGZyb20gJy4vZGVidWcnO1xuaW1wb3J0IGFwaUVuZHBvaW50IGZyb20gJy4vZW5kcG9pbnQnO1xuaW1wb3J0IHsgZXJyb3JSZXBvcnRpbmdNaWRkbGV3YXJlLCBmaW5hbCwgbG9nLCBzZXJ2ZUZhdmljb24gfSBmcm9tICcuL21pZGRsZXdhcmUnO1xuaW1wb3J0IHdlYiBmcm9tICcuL3dlYic7XG5pbXBvcnQgd2ViQVBJIGZyb20gJy4vd2ViL2FwaSc7XG5cbmNvbnN0IGRlZmluZUFQSSA9IGZ1bmN0aW9uIChjb25maWc6IElDb25maWcsIHN0b3JhZ2U6IElTdG9yYWdlSGFuZGxlcik6IGFueSB7XG4gIGNvbnN0IGF1dGg6IElBdXRoID0gbmV3IEF1dGgoY29uZmlnKTtcbiAgY29uc3QgYXBwOiBBcHBsaWNhdGlvbiA9IGV4cHJlc3MoKTtcblxuICAvLyBydW4gaW4gcHJvZHVjdGlvbiBtb2RlIGJ5IGRlZmF1bHQsIGp1c3QgaW4gY2FzZVxuICAvLyBpdCBzaG91bGRuJ3QgbWFrZSBhbnkgZGlmZmVyZW5jZSBhbnl3YXlcbiAgYXBwLnNldCgnZW52JywgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ3Byb2R1Y3Rpb24nKTtcbiAgYXBwLnVzZShjb3JzKCkpO1xuXG4gIC8vIFJvdXRlciBzZXR1cFxuICBhcHAudXNlKGxvZyhjb25maWcpKTtcbiAgYXBwLnVzZShlcnJvclJlcG9ydGluZ01pZGRsZXdhcmUpO1xuICBpZiAoY29uZmlnLnVzZXJfYWdlbnQpIHtcbiAgICBhcHAudXNlKGZ1bmN0aW9uIChyZXE6ICRSZXF1ZXN0RXh0ZW5kLCByZXM6ICRSZXNwb25zZUV4dGVuZCwgbmV4dDogJE5leHRGdW5jdGlvblZlcik6IHZvaWQge1xuICAgICAgcmVzLnNldEhlYWRlcignWC1Qb3dlcmVkLUJ5JywgZ2V0VXNlckFnZW50KGNvbmZpZy51c2VyX2FnZW50KSk7XG4gICAgICBuZXh0KCk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgYXBwLmRpc2FibGUoJ3gtcG93ZXJlZC1ieScpO1xuICB9XG5cbiAgYXBwLnVzZShjb21wcmVzc2lvbigpKTtcblxuICBhcHAuZ2V0KCcvLS9zdGF0aWMvZmF2aWNvbi5pY28nLCBzZXJ2ZUZhdmljb24oY29uZmlnKSk7XG5cbiAgLy8gSG9vayBmb3IgdGVzdHMgb25seVxuICBpZiAoY29uZmlnLl9kZWJ1Zykge1xuICAgIGhvb2tEZWJ1ZyhhcHAsIGNvbmZpZy5zZWxmX3BhdGgpO1xuICB9XG5cbiAgLy8gcmVnaXN0ZXIgbWlkZGxld2FyZSBwbHVnaW5zXG4gIGNvbnN0IHBsdWdpbl9wYXJhbXMgPSB7XG4gICAgY29uZmlnOiBjb25maWcsXG4gICAgbG9nZ2VyOiBsb2dnZXIsXG4gIH07XG5cbiAgY29uc3QgcGx1Z2luczogSVBsdWdpbk1pZGRsZXdhcmU8SUNvbmZpZz5bXSA9IGxvYWRQbHVnaW4oY29uZmlnLCBjb25maWcubWlkZGxld2FyZXMsIHBsdWdpbl9wYXJhbXMsIGZ1bmN0aW9uIChwbHVnaW46IElQbHVnaW5NaWRkbGV3YXJlPElDb25maWc+KSB7XG4gICAgcmV0dXJuIHBsdWdpbi5yZWdpc3Rlcl9taWRkbGV3YXJlcztcbiAgfSk7XG4gIHBsdWdpbnMuZm9yRWFjaCgocGx1Z2luOiBJUGx1Z2luTWlkZGxld2FyZTxJQ29uZmlnPikgPT4ge1xuICAgIHBsdWdpbi5yZWdpc3Rlcl9taWRkbGV3YXJlcyhhcHAsIGF1dGgsIHN0b3JhZ2UpO1xuICB9KTtcblxuICAvLyBGb3IgIG5wbSByZXF1ZXN0XG4gIGFwcC51c2UoYXBpRW5kcG9pbnQoY29uZmlnLCBhdXRoLCBzdG9yYWdlKSk7XG5cbiAgLy8gRm9yIFdlYlVJICYgV2ViVUkgQVBJXG4gIGlmIChfLmdldChjb25maWcsICd3ZWIuZW5hYmxlJywgdHJ1ZSkpIHtcbiAgICBhcHAudXNlKCcvJywgd2ViKGNvbmZpZywgYXV0aCwgc3RvcmFnZSkpO1xuICAgIGFwcC51c2UoJy8tL3ZlcmRhY2Npby8nLCB3ZWJBUEkoY29uZmlnLCBhdXRoLCBzdG9yYWdlKSk7XG4gIH0gZWxzZSB7XG4gICAgYXBwLmdldCgnLycsIGZ1bmN0aW9uIChyZXE6ICRSZXF1ZXN0RXh0ZW5kLCByZXM6ICRSZXNwb25zZUV4dGVuZCwgbmV4dDogJE5leHRGdW5jdGlvblZlcikge1xuICAgICAgbmV4dChFcnJvckNvZGUuZ2V0Tm90Rm91bmQoQVBJX0VSUk9SLldFQl9ESVNBQkxFRCkpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gQ2F0Y2ggNDA0XG4gIGFwcC5nZXQoJy8qJywgZnVuY3Rpb24gKHJlcTogJFJlcXVlc3RFeHRlbmQsIHJlczogJFJlc3BvbnNlRXh0ZW5kLCBuZXh0OiAkTmV4dEZ1bmN0aW9uVmVyKSB7XG4gICAgbmV4dChFcnJvckNvZGUuZ2V0Tm90Rm91bmQoQVBJX0VSUk9SLkZJTEVfTk9UX0ZPVU5EKSk7XG4gIH0pO1xuXG4gIGFwcC51c2UoZnVuY3Rpb24gKGVycjogSHR0cEVycm9yLCByZXE6ICRSZXF1ZXN0RXh0ZW5kLCByZXM6ICRSZXNwb25zZUV4dGVuZCwgbmV4dDogJE5leHRGdW5jdGlvblZlcikge1xuICAgIGlmIChfLmlzRXJyb3IoZXJyKSkge1xuICAgICAgaWYgKGVyci5jb2RlID09PSAnRUNPTk5BQk9SVCcgJiYgcmVzLnN0YXR1c0NvZGUgPT09IEhUVFBfU1RBVFVTLk5PVF9NT0RJRklFRCkge1xuICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgfVxuICAgICAgaWYgKF8uaXNGdW5jdGlvbihyZXMubG9jYWxzLnJlcG9ydF9lcnJvcikgPT09IGZhbHNlKSB7XG4gICAgICAgIC8vIGluIGNhc2Ugb2YgdmVyeSBlYXJseSBlcnJvciB0aGlzIG1pZGRsZXdhcmUgbWF5IG5vdCBiZSBsb2FkZWQgYmVmb3JlIGVycm9yIGlzIGdlbmVyYXRlZFxuICAgICAgICAvLyBmaXhpbmcgdGhhdFxuICAgICAgICBlcnJvclJlcG9ydGluZ01pZGRsZXdhcmUocmVxLCByZXMsIF8ubm9vcCk7XG4gICAgICB9XG4gICAgICByZXMubG9jYWxzLnJlcG9ydF9lcnJvcihlcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsIHRvIE1pZGRsZXdhcmUuZmluYWxcbiAgICAgIHJldHVybiBuZXh0KGVycik7XG4gICAgfVxuICB9KTtcblxuICBhcHAudXNlKGZpbmFsKTtcblxuICByZXR1cm4gYXBwO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgKGFzeW5jIGZ1bmN0aW9uIChjb25maWdIYXNoOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICBzZXR1cChjb25maWdIYXNoLmxvZ3MpO1xuICBjb25zdCBjb25maWc6IElDb25maWcgPSBuZXcgQXBwQ29uZmlnKF8uY2xvbmVEZWVwKGNvbmZpZ0hhc2gpKTtcbiAgLy8gcmVnaXN0ZXIgbWlkZGxld2FyZSBwbHVnaW5zXG4gIGNvbnN0IHBsdWdpbl9wYXJhbXMgPSB7XG4gICAgY29uZmlnOiBjb25maWcsXG4gICAgbG9nZ2VyOiBsb2dnZXIsXG4gIH07XG4gIGNvbnN0IGZpbHRlcnMgPSBsb2FkUGx1Z2luKGNvbmZpZywgY29uZmlnLmZpbHRlcnMgfHwge30sIHBsdWdpbl9wYXJhbXMsIChwbHVnaW46IElQbHVnaW5TdG9yYWdlRmlsdGVyPElDb25maWc+KSA9PiBwbHVnaW4uZmlsdGVyX21ldGFkYXRhKTtcbiAgY29uc3Qgc3RvcmFnZTogSVN0b3JhZ2VIYW5kbGVyID0gbmV3IFN0b3JhZ2UoY29uZmlnKTtcbiAgLy8gd2FpdHMgdW50aWwgaW5pdCBjYWxscyBoYXZlIGJlZW4gaW5pdGlhbGl6ZWRcbiAgYXdhaXQgc3RvcmFnZS5pbml0KGNvbmZpZywgZmlsdGVycyk7XG4gIHJldHVybiBkZWZpbmVBUEkoY29uZmlnLCBzdG9yYWdlKTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBS0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFQSxNQUFNQSxTQUFTLEdBQUcsVUFBVUMsTUFBVixFQUEyQkMsT0FBM0IsRUFBMEQ7RUFDMUUsTUFBTUMsSUFBVyxHQUFHLElBQUlDLGFBQUosQ0FBU0gsTUFBVCxDQUFwQjtFQUNBLE1BQU1JLEdBQWdCLEdBQUcsSUFBQUMsZ0JBQUEsR0FBekIsQ0FGMEUsQ0FJMUU7RUFDQTs7RUFDQUQsR0FBRyxDQUFDRSxHQUFKLENBQVEsS0FBUixFQUFlQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsUUFBWixJQUF3QixZQUF2QztFQUNBTCxHQUFHLENBQUNNLEdBQUosQ0FBUSxJQUFBQyxhQUFBLEdBQVIsRUFQMEUsQ0FTMUU7O0VBQ0FQLEdBQUcsQ0FBQ00sR0FBSixDQUFRLElBQUFFLGVBQUEsRUFBSVosTUFBSixDQUFSO0VBQ0FJLEdBQUcsQ0FBQ00s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